{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>商品列表</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static 'goods/product.css' %}">
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <a class="navbar-brand" href="#">商品列表</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="true" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse show" id="navbarCollapse" style="">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                <a class="nav-link" href="javascript:void(0)">首页 <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                <a class="nav-link" href="http://127.0.0.1:8000/goods/map" target="_blank">地图</a>
                </li>
                <li class="nav-item active">
                <a class="nav-link" href="goods/product">商品</a>
                </li>
                <li class="nav-item">
                <a class="nav-link" href="javascript:void(0)">我的</a>
                </li>
            </ul>
            <form class="form-inline mt-2 mt-md-0">
                <input class="form-control mr-sm-2" type="text" placeholder="搜索商家" aria-label="搜索商家">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>

    <div class="center-content">
        <div class="filter-box">
            <div class="filter-classify">
                <div class="label">
                    <label>商品分类</label>
                </div>
                <div class="tags">
                    <div class="tag-group tag-group-expend" id="list_cat_1">
                        <div>
                            <a class="tag tag-solid tag-large" id="c00"><span>全部</span></a>
                        </div>
                        <div>
                            <a class="tag tag-empty " id="c01"><span>数码产品</span></a>
                        </div>
                        <div>
                            <a class="tag tag-empty " id="c02"><span>图书</span></a>
                        </div>
                        <div>
                            <a class="tag tag-empty " id="c03"><span>服鞋包配饰</span></a>
                        </div>
                        <div>
                            <a class="tag tag-empty " id="c04"><span>乐器玩具</span></a>
                        </div>
                        <div>
                            <a class="tag tag-expend " id="c05"><span>配件设备工具</span></a>
                        </div>
                        <div>
                            <a class="tag tag-empty " id="c06"><span>车房</span></a>
                        </div>
                        <div>
                            <a class="tag tag-empty " id="c07"><span>其他</span></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="filter-component" id="list_cat_2">
                <div class="label">
                    <label>交易类型</label>
                </div>
                <div class="tags">
                    <div>
                        <a class="tag tag-solid tag-large" id="b00"><span>全部</span></a>
                    </div>
                    <div>
                        <a class="tag tag-expend " id="b01"><span>租</span></a>
                    </div>
                    <div>
                        <a class="tag tag-expend " id="b02"><span>卖</span></a>
                    </div>
                    <div>
                        <a class="tag tag-expend " id="b03"><span>送</span></a>
                    </div>
                </div>
            </div>
            <div id="goodlist">
                <ul>
                    {% for good in contacts.object_list %}
                        <li id={{ good.id }} class="good_list">
                            <div class="card" style="width: 18rem;">
                                <div id="carouselExampleIndicators{{ good.id }}" class="carousel slide" data-ride="carousel">
                                      <ol class="carousel-indicators">
                                        <li data-target="#carouselExampleIndicators{{ good.id }}" data-slide-to="0" class="active"></li>
                                        <li data-target="#carouselExampleIndicators{{ good.id }}" data-slide-to="1"></li>
                                        <li data-target="#carouselExampleIndicators{{ good.id }}" data-slide-to="2"></li>
                                      </ol>
                                      <div class="carousel-inner">
                                          <div class="carousel-item active">
                                              <img src="{{ good.img_1.url }}" class="card-img-top" alt="Good image" class="d-block w-100">
                                          </div>
                                          <div class="carousel-item">
                                              <img src="{{ good.img_2.url }}" class="card-img-top" alt="Good image" class="d-block w-100">
                                          </div>
                                          <div class="carousel-item">
                                              <img src="{{ good.img_3.url }}" class="card-img-top" alt="Good image" class="d-block w-100">
                                          </div>
                                      </div>
                                    <a class="carousel-control-prev" href="#carouselExampleIndicators{{ good.id }}" role="button" data-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                    <a class="carousel-control-next" href="#carouselExampleIndicators{{ good.id }}" role="button" data-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </div>

                                <div class="card-body">
                                    <h5 class="card-title">{{ good.title }}<br><span class="price">	&#165;{{ good.price }}</span></h5>
                                </div>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">联系电话：{{ good.phone }}</li>
                                    <li class="list-group-item">交易地址：{{ good.address }}</li>
                                    <li class="list-group-item description" style="height: 80px;overflow: hidden;">商品描述：{{ good.description }}</li>
                                </ul>
                            </div>

                        </li>
                    {% endfor %}
                </ul>
            </div>
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-center">

                    {% if contacts.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ contacts.previous_page_number }}" tabindex="-1">上一页</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?page={{ contacts.previous_page_number }}">{{ contacts.previous_page_number }}
                            </a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <a class="page-link" href="javascript:void(0)" tabindex="-1">上一页</a>
                        </li>
                    {% endif %}

                    <li class="page-item active">
                        <a class="page-link" href="?page={{ contacts.number }}">{{ contacts.number }}</a>
                    </li>

                    {% if contacts.has_next %}
                        <li class="page-item" >
                            <a class="page-link" href="?page={{ contacts.next_page_number }}">{{ contacts.next_page_number  }}</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?page={{ contacts.next_page_number  }}">下一页</a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <a class="page-link" href="javascript:void(0)">下一页</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </div>

    <!--<div class="common-list">
        <div class="sort-option">
            <div class="tag-group tag-group-sort">
                <div>
                    <a class="tag tag-empty tag-highlight tag-large" href="http://bj.meituan.com/shenghuo/"><span>时间排序</span></a>
                </div>
                <div>
                    <a class="tag tag-sort tag-sort-up tag-sort-down " href="http://bj.meituan.com/shenghuo/jiagezuidi/"><span>价格排序</span></a>
                </div>
            </div>
        </div>
    </div>-->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script>
        $(".card").mouseover(function () {
            $(this).css({"cursor":"pointer", "box-shadow":"0px 0px 6px 1px #80bdff", "z-index": 2});
            $(this).find(".description").css({"height":"auto"});
        });
        $(".card").mouseout(function () {
            $(this).css({"cursor":"auto", "box-shadow": "none", "z-index": 1});
            $(this).find(".description").css({"height":"80px"});
        });
        /**$(".carousel").click(function () {
            $("body").append("<div id = 'zoom'><button type='button' id='img_close' class = 'close'><span>×</span></button></div>");
            $("#zoom").append("<div id='"+$(this).attr('id')+"' class='carousel slide' data-ride='carousel'>"+$(this).html()+"</div>");
            $("#img_close").click(function () {
                $("#zoom").remove();
            });
        });*/
        let c01="c01";
        let c02="c02";
        let c03="c03";
        let c04="c04";
        let c05="c05";
        let c06="c06";
        let c07="c07";
        let b01="b01";
        let b02="b02";
        let b03="b03";
        let c00="c00";
        let b00="b00";

        let cat_list_1 = document.getElementById("list_cat_1");
        let cat_list_2 = document.getElementById("list_cat_2");
        let a_list_1 = cat_list_1.getElementsByTagName("a");
        let a_list_2 = cat_list_2.getElementsByTagName("a");
        let a_cat_1;
        let a_cat_2;
        let cat_text;
        {% if cat_text.l_cat %}
            a_cat_1={{ cat_text.cat }};
            a_cat_2={{ cat_text.l_cat }};
        {% else %}
            cat_text={{ cat_text }};
            if(cat_text.substring(0,1)=="c"){
                a_cat_1=cat_text;
                a_cat_2="b00";
            }
            else {
                a_cat_2=cat_text;
                a_cat_1="c00";
            }
        {% endif %}
        document.getElementById(a_cat_1).className="checked_a";
        document.getElementById(a_cat_2).className="checked_a";

        for(let j=0;j<a_list_1.length;j++) {
            let a_id = a_list_1[j].id;
            if(a_id=="c00"){
                a_id = '';
            }
            if(a_cat_2=="b00") {
                a_cat_2 = '';
            }
            if (a_id=='') {
                a_list_1[j].href="http://127.0.0.1:8000/goods/product"+a_id+"/"+a_cat_2;
            }
            else
                a_list_1[j].href="http://127.0.0.1:8000/goods/product/"+a_id+"/"+a_cat_2;
        }
        for(let j=0;j<a_list_2.length;j++) {
            let a_id = a_list_2[j].id;
            if(a_id=="b00"){
                a_id = '';
            }
            if(a_cat_1=="c00") {
                a_cat_1 = '';
            }
            if (a_cat_1=='') {
                a_list_2[j].href = "http://127.0.0.1:8000/goods/product" + a_cat_1 + "/"+ a_id;
            }
            else
                a_list_2[j].href = "http://127.0.0.1:8000/goods/product/" + a_cat_1 + "/"+ a_id;
        }

    </script>

</body>
</html>